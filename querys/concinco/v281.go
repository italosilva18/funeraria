package concinco

type Concinco281 struct{}

// 1. TOTAL_VENDIDO_DIA
func (c *Concinco281) TOTAL_VENDIDO_DIA() string {
	return `SELECT sum( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) AS VENDA, sum( ( ( (Y.CMDIAVLRNF) + Y.CMDIAIPI - Y.CMDIACREDICMS - nvl( Y.CMDIACREDPIS, 0 ) - nvl( Y.CMDIACREDCOFINS, 0 ) - nvl( Y.CMDIACREDIPI, 0 ) + Y.CMDIAICMSST + Y.CMDIADESPNF + Y.CMDIADESPFORANF - Y.CMDIADCTOFORANF ) * CASE WHEN DV.UTILACRESCCUSTPRODRELAC = 'S' AND NVL(A.SEQPRODUTOBASE, A.SEQPRODUTOBASEANTIGO) IS NOT NULL THEN COALESCE(PR.PERCACRESCCUSTORELACVIG, NVL(F_RETACRESCCUSTORELACABC(V.SEQPRODUTO, V.DTAVDA), 1)) ELSE 1 END * DECODE('S', 'N', 1, NVL( a.propqtdprodutobase, 1) ) - ( decode( Y.QTDVERBAVDA, 0, 0, Y.VLRVERBAVDA * NVL( a.propqtdprodutobase, 1 ) / DECODE(NVL(Y.QTDVDA, 0), 0, Y.QTDVERBAVDA, Y.QTDVDA) ) ) + decode (V.ACMCOMPRAVENDA, 'N', 0, decode( 'N', 'S', 0, ( decode( nvl( Y.VLRVERBAVDAACR, 0 ), 0, 0, Y.VLRVERBAVDAACR * NVL( a.propqtdprodutobase, 1 ) / DECODE(NVL(Y.QTDVDA, 0), 0, 1, Y.QTDVDA) ) ) ) ) ) * (V.QTDITEM - V.QTDDEVOLITEM)) AS CUSTOS, round(sum( fC5_AbcDistribLucratividade( 'L', 'L', 'N', round( V.VLRITEM, 2 ) , 'N', V.VLRICMSST, V.VLRFCPST, V.VLRICMSSTEMPORIG, E.UF, V.UFPESSOA, 'N', 0, 'N', V.VLRIPIITEM, V.VLRIPIDEVOLITEM, 'N', V.VLRDESCFORANF, Y.CMDIAVLRNF - 0 , Y.CMDIAIPI, nvl( Y.CMDIACREDPIS, 0 ), nvl( Y.CMDIACREDCOFINS, 0 ), Y.CMDIAICMSST, Y.CMDIADESPNF, Y.CMDIADESPFORANF, Y.CMDIADCTOFORANF, 'S', a.propqtdprodutobase, V.QTDITEM, V.VLREMBDESCRESSARCST, V.ACMCOMPRAVENDA, V.PISITEM, V.COFINSITEM, decode( V.TIPCGO, 'S', Y.QTDVDA, nvl( Y.QTDDEVOL, Y.QTDVDA ) ), ( decode( V.TIPCGO, 'S', Y.VLRIMPOSTOVDA - nvl( Y.VLRIPIVDA, 0 ), nvl( Y.VLRIMPOSTODEVOL - nvl( V.VLRIPIDEVOLITEM, 0 ), Y.VLRIMPOSTOVDA - nvl( Y.VLRIPIVDA, 0 ) ) ) ) , 'N', V.VLRDESPOPERACIONALITEM, Y.VLRDESPESAVDA, 'N', nvl( Y.VLRVERBAVDAACR, 0 ), V.QTDVERBAVDA, V.VLRVERBAVDA, 'N', NVL(V.VLRTOTCOMISSAOITEM, 0), V.VLRDEVOLITEM, VLRDEVOLICMSST, V.DVLRFCPST, V.QTDDEVOLITEM, V.PISDEVOLITEM, V.COFINSDEVOLITEM, V.VLRDESPOPERACIONALITEMDEVOL, V.VLRTOTCOMISSAOITEMDEVOL, E.PERIRLUCRAT, E.PERCSLLLUCRAT, Y.CMDIACREDICMS, decode( V.ICMSEFETIVOITEM, 0, V.ICMSITEM, V.ICMSEFETIVOITEM ), V.VLRFCPICMS, V.PERCPMF, V.PEROUTROIMPOSTO, decode( V.ICMSEFETIVODEVOLITEM, 0, V.ICMSDEVOLITEM, V.ICMSEFETIVODEVOLITEM ), V.DVLRFCPICMS, CASE WHEN ('S') = 'N' THEN (nvl(y.cmdiavlrdescpistransf, 0) + nvl(y.cmdiavlrdesccofinstransf, 0) + nvl(y.cmdiavlrdescicmstransf, 0) + nvl(y.cmdiavlrdescipitransf, 0) + nvl(y.cmdiavlrdesclucrotransf, 0) + nvl(y.cmdiavlrdescverbatransf, 0) ) ELSE 0 END, CASE WHEN DV.UTILACRESCCUSTPRODRELAC = 'S' AND nvl( A.SEQPRODUTOBASE, A.SEQPRODUTOBASEANTIGO ) IS NOT NULL THEN COALESCE( PR.PERCACRESCCUSTORELACVIG, nvl( F_RETACRESCCUSTORELACABC( V.SEQPRODUTO, V.DTAVDA ), 1 ) ) ELSE 1 END, 'N', 0, 0, 'S', V.VLRDESCMEDALHA, 'S', V.VLRDESCFORNEC, V.VLRDESCFORNECDEVOL, 'N', V.VLRFRETEITEMRATEIO, V.VLRFRETEITEMRATEIODEV, 'S', V.VLRICMSSTEMBUTPROD, V.VLRICMSSTEMBUTPRODDEV, V.VLREMBDESCRESSARCSTDEVOL, CASE WHEN 'N' = 'S' THEN nvl( V.VLRDESCACORDOVERBAPDV, 0 ) ELSE 0 END, nvl( Y.CMDIACREDIPI, 0 ), NVL(V.VLRITEMRATEIOCTE, 0), 'N', 'I' )), 2 ) AS LUCRO FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.DTAVDA = :1 AND V.NROEMPRESA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' )`
}

// 2. TICKET_MEDIO_DIA
func (c *Concinco281) TICKET_MEDIO_DIA() string {
	return `SELECT ROUND(fC5_Divide( sum( ( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) + nvl( VLREMBDESCRESSARCST, 0 ) - nvl( VLREMBDESCRESSARCSTDEVOL, 0 ) ) , count( DISTINCT V.ROWIDDOCTO ) ), 2) AS MEDVLRDOCTO FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' )`
}

// 3. PRODUTOS_POR_ATENDIMENTO_DIA
func (c *Concinco281) PRODUTOS_POR_ATENDIMENTO_DIA() string {
	return `SELECT ROUND(fC5_Divide( sum( round(( V.QTDITEM - V.QTDDEVOLITEM ) / K.QTDEMBALAGEM , 6) ) , count( DISTINCT V.ROWIDDOCTO ) ), 2) AS MEDIA_ITENS FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' )`
}

// 4. TOTAL_CUPONS_VALIDOS_DIA
func (c *Concinco281) TOTAL_CUPONS_VALIDOS_DIA() string {
	return `SELECT count( DISTINCT V.ROWIDDOCTO ) FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' )`
}

// 5. TOTAL_CUPONS_CANCELADOS_DIA
func (c *Concinco281) TOTAL_CUPONS_CANCELADOS_DIA() string {
	return `SELECT COUNT(1) CUPONS_CANCELADOS FROM MFL_DOCTOFISCAL C WHERE C.STATUSDF = 'C' AND C.CODGERALOPER IN ( SELECT XC.CODGERALOPER FROM MAX_CODGERALOPER XC WHERE XC.TIPCGO = 'S' AND XC.TIPUSO = 'E' AND XC.TIPDOCFISCAL = 'C') AND C.DTAMOVIMENTO = :1 AND C.NROEMPRESA = :2`
}

// 6. VENDAS_POR_FAIXA_HORARIA
func (c *Concinco281) VENDAS_POR_FAIXA_HORARIA() string {
	return `SELECT TO_CHAR(V.dtahorlancto, 'HH24') HORA, sum( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) AS VALOR, count( DISTINCT V.ROWIDDOCTO ) AS NUM_CUPONS, ROUND(sum( round(( V.QTDITEM - V.QTDDEVOLITEM ) / K.QTDEMBALAGEM , 6) ), 0) AS NUM_ITENS, ROUND(fC5_Divide( sum( round(( V.QTDITEM - V.QTDDEVOLITEM ) / K.QTDEMBALAGEM , 6) ) , count( DISTINCT V.ROWIDDOCTO ) ), 2) AS MEDIA_ITENS, ROUND(fC5_Divide( sum( ( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) + nvl( VLREMBDESCRESSARCST, 0 ) - nvl( VLREMBDESCRESSARCSTDEVOL, 0 ) ) , count( DISTINCT V.ROWIDDOCTO ) ), 2) AS MEDIA_VALOR FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' ) GROUP BY TO_CHAR(V.dtahorlancto, 'HH24') ORDER BY 1`
}

// 7. PRODUTOS_MAIS_VENDIDO_DIA
func (c *Concinco281) PRODUTOS_MAIS_VENDIDO_DIA() string {
	return `SELECT ROWNUM, C.*, round((c.total - c.custo), 2) AS lucro FROM ( SELECT A.SEQPRODUTO AS cod_produto, A.DESCCOMPLETA AS descricao, round(fC5_Divide(sum((round(V.VLRITEM, 2)) - (round(V.VLRDEVOLITEM, 2) - (0))), round(sum(round((V.QTDITEM - V.QTDDEVOLITEM) / K.QTDEMBALAGEM, 6)), 4)), 2) AS VLR_UNITARIO, sum(round((V.QTDITEM - V.QTDDEVOLITEM) / K.QTDEMBALAGEM, 6)) AS QUANTIDADE, sum((round(V.VLRITEM, 2)) - (round(V.VLRDEVOLITEM, 2) - (0))) AS TOTAL, sum((((Y.CMDIAVLRNF) + Y.CMDIAIPI - Y.CMDIACREDICMS - nvl(Y.CMDIACREDPIS, 0) - nvl(Y.CMDIACREDCOFINS, 0) - nvl(Y.CMDIACREDIPI, 0) + Y.CMDIAICMSST + Y.CMDIADESPNF + Y.CMDIADESPFORANF - Y.CMDIADCTOFORANF) * CASE WHEN DV.UTILACRESCCUSTPRODRELAC = 'S' AND NVL(A.SEQPRODUTOBASE, A.SEQPRODUTOBASEANTIGO) IS NOT NULL THEN COALESCE(PR.PERCACRESCCUSTORELACVIG, NVL(F_RETACRESCCUSTORELACABC(V.SEQPRODUTO, V.DTAVDA), 1)) ELSE 1 END * DECODE('S', 'N', 1, NVL(a.propqtdprodutobase, 1)) - (decode(Y.QTDVERBAVDA, 0, 0, Y.VLRVERBAVDA * NVL(a.propqtdprodutobase, 1) / DECODE(NVL(Y.QTDVDA, 0), 0, Y.QTDVERBAVDA, Y.QTDVDA))) + decode(V.ACMCOMPRAVENDA, 'N', 0, decode('N', 'S', 0, (decode(nvl(Y.VLRVERBAVDAACR, 0), 0, 0, Y.VLRVERBAVDAACR * NVL(a.propqtdprodutobase, 1) / DECODE(NVL(Y.QTDVDA, 0), 0, 1, Y.QTDVDA)))))) * (V.QTDITEM - V.QTDDEVOLITEM)) AS CUSTO FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl(E.NROEMPCUSTOABC, E.NROEMPRESA) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ('S', 'I') GROUP BY A.SEQPRODUTO, A.DESCCOMPLETA ORDER BY 4 DESC) c WHERE rownum <= 200`
}

// 8. PRODUTOS_ESTATISTICA
func (c *Concinco281) PRODUTOS_ESTATISTICA() string {
	return `SELECT ROWNUM, C.*, round((c.total - c.custo),2) as lucro FROM (SELECT A.SEQPRODUTO as cod_produto, A.DESCCOMPLETA as descricao, round(fC5_Divide(sum((round(V.VLRITEM, 2)) - (round(V.VLRDEVOLITEM, 2) - (0))), round(sum(round((V.QTDITEM - V.QTDDEVOLITEM) / K.QTDEMBALAGEM, 6)), 4)),2) as VLR_UNITARIO, sum(round((V.QTDITEM - V.QTDDEVOLITEM) / K.QTDEMBALAGEM, 6)) as QUANTIDADE, sum((round(V.VLRITEM, 2)) - (round(V.VLRDEVOLITEM, 2) - (0))) as TOTAL, sum((((Y.CMDIAVLRNF) + Y.CMDIAIPI - Y.CMDIACREDICMS - nvl(Y.CMDIACREDPIS, 0) - nvl(Y.CMDIACREDCOFINS, 0) - nvl(Y.CMDIACREDIPI, 0) + Y.CMDIAICMSST + Y.CMDIADESPNF + Y.CMDIADESPFORANF - Y.CMDIADCTOFORANF) * CASE WHEN DV.UTILACRESCCUSTPRODRELAC = 'S' AND NVL(A.SEQPRODUTOBASE, A.SEQPRODUTOBASEANTIGO) IS NOT NULL THEN COALESCE(PR.PERCACRESCCUSTORELACVIG, NVL(F_RETACRESCCUSTORELACABC(V.SEQPRODUTO, V.DTAVDA), 1)) ELSE 1 END * DECODE('S', 'N', 1, NVL(a.propqtdprodutobase, 1)) - (decode(Y.QTDVERBAVDA, 0, 0, Y.VLRVERBAVDA * NVL(a.propqtdprodutobase, 1) / DECODE(NVL(Y.QTDVDA, 0), 0, Y.QTDVERBAVDA, Y.QTDVDA))) + decode(V.ACMCOMPRAVENDA, 'N', 0, decode('N', 'S', 0, (decode(nvl(Y.VLRVERBAVDAACR, 0), 0, 0, Y.VLRVERBAVDAACR * NVL(a.propqtdprodutobase, 1) / DECODE(NVL(Y.QTDVDA, 0), 0, 1, Y.QTDVDA)))))) * (V.QTDITEM - V.QTDDEVOLITEM)) as CUSTO FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl(E.NROEMPCUSTOABC, E.NROEMPRESA) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ('S', 'I') GROUP BY A.SEQPRODUTO, A.DESCCOMPLETA ORDER BY 4 DESC) c WHERE rownum <= 8000`
}

// 9. TOTAL_VENDIDO_POR_MODALIDADES
func (c *Concinco281) TOTAL_VENDIDO_POR_MODALIDADES() string {
	return `SELECT A2.NROFORMAPAGTO CODIGO, NVL(A2.FORMAPAGTO, 'MODALIDADE DESCONHECIDA') AS DESCRICAO, count( DISTINCT V.ROWIDDOCTO ) AS NRODOCTOS, sum( (V.VLRITEM) - ( V.VLRDEVOLITEM - (0) ) ) AS VLRVENDA FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR, MRL_FORMAPAGTO A2 WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND V.NROFORMAPAGTO = A2.NROFORMAPAGTO(+) AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' ) GROUP BY A2.NROFORMAPAGTO, NVL(A2.FORMAPAGTO, 'MODALIDADE DESCONHECIDA') ORDER BY 2`
}

// 10. ESTORNO_DE_CUPONS_POR_OPERADOR_DIA
func (c *Concinco281) ESTORNO_DE_CUPONS_POR_OPERADOR_DIA() string {
	return `SELECT C.NROECF PDV, TO_CHAR(C.DTAHOREMISSAO, 'DD/MM/YYYY') data, TO_CHAR(C.DTAHOREMISSAO, 'HH:MM:SS') HORA, U.NOME OPERADOR, C.USUCANCELOU SUPERVISOR, SUM(I.VLRITEM) TOTAL, C.NUMERODF CUPOM FROM MFL_DOCTOFISCAL C, MFL_DFITEM I, GE_USUARIO U WHERE C.NUMERODF = I.NUMERODF AND C.NROEMPRESA = I.NROEMPRESA AND C.SERIEDF = I.SERIEDF AND C.SEQNF = I.SEQNF AND C.STATUSDF != 'V' AND C.SEQOPERADOR = U.SEQUSUARIO AND C.CODGERALOPER IN ( SELECT XC.CODGERALOPER FROM MAX_CODGERALOPER XC WHERE XC.TIPCGO = 'S' AND XC.TIPUSO = 'E' AND XC.TIPDOCFISCAL = 'C') AND C.DTAMOVIMENTO = :1 AND C.NROEMPRESA = :2 GROUP BY C.NROECF, C.DTAHOREMISSAO, C.DTAHOREMISSAO, U.NOME, C.USUCANCELOU, C.NUMERODF ORDER BY 7`
}

// 11. DESCONTOS_DE_ITENS_DIA
func (c *Concinco281) DESCONTOS_DE_ITENS_DIA() string {
	return `SELECT TO_CHAR(C.DTAHOREMISSAO, 'DD/MM/YYYY') data, TO_CHAR(C.DTAHOREMISSAO, 'HH:MM:SS') HORA, U.NOME OPERADOR, SUM(I.VLRDESCONTO) VALOR, I.NUMERODF CUPOM, I.SEQPRODUTO ITEM, I.CODPRODUTO EAN, P.DESCCOMPLETA DESCRICAO FROM MFL_DOCTOFISCAL C, MFL_DFITEM I, GE_USUARIO U, MAP_PRODUTO P WHERE C.NUMERODF = I.NUMERODF AND C.NROEMPRESA = I.NROEMPRESA AND C.SERIEDF = I.SERIEDF AND C.SEQNF = I.SEQNF AND I.SEQPRODUTO = P.SEQPRODUTO AND C.STATUSDF = 'V' AND C.SEQOPERADOR = U.SEQUSUARIO AND C.CODGERALOPER IN ( SELECT XC.CODGERALOPER FROM MAX_CODGERALOPER XC WHERE XC.TIPCGO = 'S' AND XC.TIPUSO = 'E' AND XC.TIPDOCFISCAL = 'C') AND C.DTAMOVIMENTO = :1 AND C.NROEMPRESA = :2 AND I.VLRDESCONTO > 0 GROUP BY C.DTAHOREMISSAO, C.DTAHOREMISSAO, U.NOME, I.NUMERODF, I.SEQPRODUTO, I.CODPRODUTO, P.DESCCOMPLETA ORDER BY 7`
}

// 12. VENDAS_POR_SECOES_DIA
func (c *Concinco281) VENDAS_POR_SECOES_DIA() string {
	return `SELECT G.SEQCATEGORIA AS codigo, G.CATEGORIA AS descricao, sum( round(( V.QTDITEM - V.QTDDEVOLITEM ) / K.QTDEMBALAGEM , 6) ) AS QUANTIDADE, sum( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) AS VALOR, sum( ( ( (Y.CMDIAVLRNF) + Y.CMDIAIPI - Y.CMDIACREDICMS - nvl( Y.CMDIACREDPIS, 0 ) - nvl( Y.CMDIACREDCOFINS, 0 ) - nvl( Y.CMDIACREDIPI, 0 ) + Y.CMDIAICMSST + Y.CMDIADESPNF + Y.CMDIADESPFORANF - Y.CMDIADCTOFORANF ) * CASE WHEN DV.UTILACRESCCUSTPRODRELAC = 'S' AND NVL(A.SEQPRODUTOBASE, A.SEQPRODUTOBASEANTIGO) IS NOT NULL THEN COALESCE(PR.PERCACRESCCUSTORELACVIG, NVL(F_RETACRESCCUSTORELACABC(V.SEQPRODUTO, V.DTAVDA), 1)) ELSE 1 END * DECODE('S', 'N', 1, NVL( a.propqtdprodutobase, 1) ) - ( decode( Y.QTDVERBAVDA, 0, 0, Y.VLRVERBAVDA * NVL( a.propqtdprodutobase, 1 ) / DECODE(NVL(Y.QTDVDA, 0), 0, Y.QTDVERBAVDA, Y.QTDVDA) ) ) + decode (V.ACMCOMPRAVENDA, 'N', 0, decode( 'N', 'S', 0, ( decode( nvl( Y.VLRVERBAVDAACR, 0 ), 0, 0, Y.VLRVERBAVDAACR * NVL( a.propqtdprodutobase, 1 ) / DECODE(NVL(Y.QTDVDA, 0), 0, 1, Y.QTDVDA) ) ) ) ) ) * (V.QTDITEM - V.QTDDEVOLITEM)) AS CUSTO, round(sum( fC5_AbcDistribLucratividade( 'L', 'L', 'N', round( V.VLRITEM, 2 ) , 'N', V.VLRICMSST, V.VLRFCPST, V.VLRICMSSTEMPORIG, E.UF, V.UFPESSOA, 'N', 0, 'N', V.VLRIPIITEM, V.VLRIPIDEVOLITEM, 'N', V.VLRDESCFORANF, Y.CMDIAVLRNF - 0 , Y.CMDIAIPI, nvl( Y.CMDIACREDPIS, 0 ), nvl( Y.CMDIACREDCOFINS, 0 ), Y.CMDIAICMSST, Y.CMDIADESPNF, Y.CMDIADESPFORANF, Y.CMDIADCTOFORANF, 'S', a.propqtdprodutobase, V.QTDITEM, V.VLREMBDESCRESSARCST, V.ACMCOMPRAVENDA, V.PISITEM, V.COFINSITEM, decode( V.TIPCGO, 'S', Y.QTDVDA, nvl( Y.QTDDEVOL, Y.QTDVDA ) ), ( decode( V.TIPCGO, 'S', Y.VLRIMPOSTOVDA - nvl( Y.VLRIPIVDA, 0 ), nvl( Y.VLRIMPOSTODEVOL - nvl( V.VLRIPIDEVOLITEM, 0 ), Y.VLRIMPOSTOVDA - nvl( Y.VLRIPIVDA, 0 ) ) ) ) , 'N', V.VLRDESPOPERACIONALITEM, Y.VLRDESPESAVDA, 'N', nvl( Y.VLRVERBAVDAACR, 0 ), V.QTDVERBAVDA, V.VLRVERBAVDA, 'N', NVL(V.VLRTOTCOMISSAOITEM, 0), V.VLRDEVOLITEM, VLRDEVOLICMSST, V.DVLRFCPST, V.QTDDEVOLITEM, V.PISDEVOLITEM, V.COFINSDEVOLITEM, V.VLRDESPOPERACIONALITEMDEVOL, V.VLRTOTCOMISSAOITEMDEVOL, E.PERIRLUCRAT, E.PERCSLLLUCRAT, Y.CMDIACREDICMS, decode( V.ICMSEFETIVOITEM, 0, V.ICMSITEM, V.ICMSEFETIVOITEM ), V.VLRFCPICMS, V.PERCPMF, V.PEROUTROIMPOSTO, decode( V.ICMSEFETIVODEVOLITEM, 0, V.ICMSDEVOLITEM, V.ICMSEFETIVODEVOLITEM ), V.DVLRFCPICMS, CASE WHEN ('S') = 'N' THEN (nvl(y.cmdiavlrdescpistransf, 0) + nvl(y.cmdiavlrdesccofinstransf, 0) + nvl(y.cmdiavlrdescicmstransf, 0) + nvl(y.cmdiavlrdescipitransf, 0) + nvl(y.cmdiavlrdesclucrotransf, 0) + nvl(y.cmdiavlrdescverbatransf, 0) ) ELSE 0 END, CASE WHEN DV.UTILACRESCCUSTPRODRELAC = 'S' AND nvl( A.SEQPRODUTOBASE, A.SEQPRODUTOBASEANTIGO ) IS NOT NULL THEN COALESCE( PR.PERCACRESCCUSTORELACVIG, nvl( F_RETACRESCCUSTORELACABC( V.SEQPRODUTO, V.DTAVDA ), 1 ) ) ELSE 1 END, 'N', 0, 0, 'S', V.VLRDESCMEDALHA, 'S', V.VLRDESCFORNEC, V.VLRDESCFORNECDEVOL, 'N', V.VLRFRETEITEMRATEIO, V.VLRFRETEITEMRATEIODEV, 'S', V.VLRICMSSTEMBUTPROD, V.VLRICMSSTEMBUTPRODDEV, V.VLREMBDESCRESSARCSTDEVOL, CASE WHEN 'N' = 'S' THEN nvl( V.VLRDESCACORDOVERBAPDV, 0 ) ELSE 0 END, nvl( Y.CMDIACREDIPI, 0 ), NVL(V.VLRITEMRATEIOCTE, 0), 'N', 'I' )), 2 ) AS LUCRO FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR, MAXV_CATEGORIA G, MAP_FAMDIVCATEG U WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.DTAVDA = :1 AND V.NROEMPRESA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND U.SEQFAMILIA = D.SEQFAMILIA AND U.NRODIVISAO = D.NRODIVISAO AND U.SEQCATEGORIA = G.SEQCATEGORIA AND U.NRODIVISAO = G.NRODIVISAO AND U.STATUS = 'A' AND G.STATUSCATEGOR != 'I' AND G.TIPCATEGORIA = 'M' AND G.NIVELHIERARQUIA = 1 AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' ) GROUP BY G.SEQCATEGORIA, G.CATEGORIA`
}

// 13. TOTAL_CUPONS_POR_OPERADOR_DIA
func (c *Concinco281) TOTAL_CUPONS_POR_OPERADOR_DIA() string {
	return `SELECT count( DISTINCT V.ROWIDDOCTO ) AS QTD_CUPONS, nvl( TRIM(V.OPERADOR), 'OPERADOR SEM DESCRICAO' ) AS OPERADOR, sum( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) AS VLRVENDA FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' ) GROUP BY nvl( TRIM(V.OPERADOR), 'OPERADOR SEM DESCRICAO' ) ORDER BY 2`
}

// 14. VENDAS_POR_VENDEDOR_DIA
func (c *Concinco281) VENDAS_POR_VENDEDOR_DIA() string {
	return `SELECT J.APELIDO AS OPERADOR, sum( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) AS VALOR, count( DISTINCT V.ROWIDDOCTO ) AS QTD_CUPONS, sum( round(( V.QTDITEM - V.QTDDEVOLITEM ) / K.QTDEMBALAGEM , 6) ) AS ITEM, ROUND(fC5_Divide( sum( round(( V.QTDITEM - V.QTDDEVOLITEM ) / K.QTDEMBALAGEM , 6) ) , count( DISTINCT V.ROWIDDOCTO ) ), 2) AS MEDIA_ITENS, ROUND(fC5_Divide( sum( ( ( round( V.VLRITEM, 2 ) ) - ( round( V.VLRDEVOLITEM, 2 ) - (0) ) ) + nvl( VLREMBDESCRESSARCST, 0 ) - nvl( VLREMBDESCRESSARCSTDEVOL, 0 ) ) , count( DISTINCT V.ROWIDDOCTO ) ), 2) AS MEDIA_VALOR FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR, MAD_REPRESENTANTE J, GE_PESSOA RPE WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.DTAVDA = :1 AND V.NROEMPRESA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND V.NROREPRESENTANTE = J.NROREPRESENTANTE AND J.SEQPESSOA = RPE.SEQPESSOA AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' ) GROUP BY J.APELIDO ORDER BY 2`
}

// 15. MODALIDADES_PAGAMENTO_OPERADOR_DIA
func (c *Concinco281) MODALIDADES_PAGAMENTO_OPERADOR_DIA() string {
	return `SELECT TO_CHAR(V.DTAVDA, 'DD/MM/YYYY') AS DATA, nvl( TRIM(V.OPERADOR), 'OPERADOR DESCONHECIDO' ) AS OPERADOR, A2.NROFORMAPAGTO COD_PAGTO, NVL(A2.FORMAPAGTO, 'MODALIDADE SEM DESCRICAO') AS DESCRICAO, count( DISTINCT V.ROWIDDOCTO ) AS QTD, sum( (V.VLRITEM) - ( V.VLRDEVOLITEM - (0) ) ) AS VALOR FROM MRL_CUSTODIA Y, MAXV_ABCDISTRIBBASE V, MAP_PRODUTO A, MAP_PRODUTO PB, MAP_FAMDIVISAO D, MAP_FAMEMBALAGEM K, MAX_EMPRESA E, MAX_DIVISAO DV, MAP_PRODACRESCCUSTORELAC PR, MRL_FORMAPAGTO A2 WHERE D.SEQFAMILIA = A.SEQFAMILIA AND D.NRODIVISAO = V.NRODIVISAO AND V.SEQPRODUTO = A.SEQPRODUTO AND V.SEQPRODUTOCUSTO = PB.SEQPRODUTO AND V.NRODIVISAO = D.NRODIVISAO AND E.NROEMPRESA = V.NROEMPRESA AND E.NRODIVISAO = DV.NRODIVISAO AND V.SEQPRODUTO = PR.SEQPRODUTO(+) AND V.DTAVDA = PR.DTAMOVIMENTACAO(+) AND V.NROEMPRESA = :1 AND V.DTAVDA = :2 AND Y.NROEMPRESA = nvl( E.NROEMPCUSTOABC, E.NROEMPRESA ) AND Y.DTAENTRADASAIDA = V.DTAVDA AND K.SEQFAMILIA = A.SEQFAMILIA AND K.QTDEMBALAGEM = 1 AND Y.SEQPRODUTO = PB.SEQPRODUTO AND V.NROFORMAPAGTO = A2.NROFORMAPAGTO(+) AND DECODE(V.TIPTABELA, 'S', V.CGOACMCOMPRAVENDA, V.ACMCOMPRAVENDA) IN ( 'S', 'I' ) GROUP BY A2.NROFORMAPAGTO, TO_CHAR(V.DTAVDA, 'DD/MM/YYYY'), NVL(A2.FORMAPAGTO, 'MODALIDADE SEM DESCRICAO'), nvl( TRIM(V.OPERADOR), 'OPERADOR DESCONHECIDO' ) ORDER BY 2`
}
